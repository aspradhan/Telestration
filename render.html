<html>
<head>
<script src="js/jquery.min.js"></script>
<script src="js/fabric.min.js"></script>
<script src="config.js"></script>
<script>
	URL = URL + "render";
</script>
<script src="js/sockets.js"></script>
<script>
var canvas;

function evalMessage(data) {
	switch (true) {
		case (data==="UP"):			// going on air
			if (!$("#c").is(":visible")) {
				$("#c").fadeIn(FADE_DURATION);
			}
			break;
		case (data==="DOWN"):		// going off air
			if ($("#c").is(":visible")) {
				$("#c").fadeOut(FADE_DURATION);
			}
			break;
		case (data.substring(0,5)=="COLOR"):
			break;
		default:
			canvas.loadFromJSON(data, canvas.renderAll.bind(canvas));
	}
}

function handleDisconnect() {
	if ($("#c").is(":visible")) {
		$("#c").fadeOut(FADE_DURATION, function() {
			canvas.clear();
		});
	} else {
		canvas.clear();
	}
}

$(document).ready( function() {
	canvas = this.__canvas = new fabric.StaticCanvas('c');
	canvas.setWidth(CANVAS_WIDTH);
	canvas.setHeight(CANVAS_HEIGHT);
	openSocket(URL);
});

</script>
<style>
html {
	overflow: hidden;
}
body {
	margin: 0;
	overflow: hidden;
}
#c {
	display: none;
}
</style>
</head>
	<body>
		<canvas id="c" class="lower-canvas"></canvas>
	</body>
</html>
